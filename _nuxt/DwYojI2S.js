import{u as b}from"./DrlRsimv.js";import{E as o}from"./DOAoupFn.js";import{g as h,m as r,o as d,c as u,a as s,q as v,v as f,i as c,t as k,d as C,x as S,_ as x}from"./C6Q-3SYB.js";import{u as T}from"./Bo41m7mU.js";import{u as j}from"./CwFJAg3J.js";import"./CMhLHvtg.js";const A=window.setInterval,B={class:"bgc"},E={class:"sbgc"},P={class:"loginBox"},V={class:"item"},I={class:"item"},N={style:{display:"block",width:"35%"}},O=["disabled"],q={key:0},z={key:1},D=h({__name:"forgetPassword",setup(M){j({title:"Login"});const n=r(""),p=r(""),{apiBaseUrl:m}=b();T();const a=r(60),l=r(!1),g=()=>{l.value=!0,a.value=60;const t=A(()=>{a.value>0?a.value--:(clearInterval(t),l.value=!1)},1e3)};async function y(t){if(p.value==""){o({message:"请输入验证码！",type:"warning"});return}try{const e=await fetch(m.value+"auth/reset_password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n.value,code:p.value})}),i=await e.json();e.ok?(o({showClose:!0,duration:0,message:"您的密码已被重置为123456,请您马上登录修改密码",type:"warning"}),S("/login")):o({message:"验证码错误！",type:"error"})}catch(e){console.error("Login error:",e)}}function w(t){return/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(t)}async function _(){if(!w(n.value)){o.error("请输入正确的邮箱！");return}console.log(n.value);try{const t=await fetch(m.value+"auth/send_reset_code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n.value})}),e=await t.json();t.ok?(o({message:"已发送验证码！",type:"success"}),g()):o.error("该邮箱与任何账号绑定！")}catch{}}return(t,e)=>(d(),u("div",B,[s("div",E,[s("div",P,[e[6]||(e[6]=s("div",{class:"title"},"Retrieve Password",-1)),s("form",null,[s("div",V,[v(s("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=i=>t.username=i),required:""},null,512),[[f,t.username]]),e[2]||(e[2]=s("label",{for:"email"},"Email",-1))]),s("div",I,[v(s("input",{type:"password","onUpdate:modelValue":e[1]||(e[1]=i=>t.password=i),required:"",style:{width:"55%"}},null,512),[[f,t.password]]),e[3]||(e[3]=s("label",{for:"code"},"Verification Code",-1)),s("div",N,[s("button",{class:"btn2",onClick:_,disabled:c(l)},[c(l)?(d(),u("div",q,k(c(a))+" 秒",1)):(d(),u("div",z,"Send Code"))],8,O)])]),e[5]||(e[5]=s("div",null,null,-1)),s("div",{style:{display:"flex","justify-content":"center"}},[s("button",{class:"btn",onClick:y},e[4]||(e[4]=[C("Confirm "),s("span",null,null,-1),s("span",null,null,-1),s("span",null,null,-1)]))])])]),e[7]||(e[7]=s("div",{class:"links"},[s("div",null,[s("a",{href:"/",class:"link"},"home")]),s("div",null,[s("a",{href:"/register",class:"link"},"sign up")])],-1))])]))}}),F=x(D,[["__scopeId","data-v-5c01b9c8"]]);export{F as default};
