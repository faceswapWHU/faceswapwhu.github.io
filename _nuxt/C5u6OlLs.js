import{u as b}from"./DReBewYT.js";import{E as o}from"./Bu65QAXf.js";import{g as k,m as i,o as d,c as u,a as s,q as m,v as f,i as p,t as h,d as C,x as S,_ as x}from"./SB7nfnlm.js";import{u as T}from"./DLxffZpz.js";import{u as j}from"./Cu3t_kiS.js";import"./0a9C30fr.js";const A=window.setInterval,B={class:"bgc"},E={class:"sbgc"},P={class:"loginBox"},I={class:"item"},N={class:"item"},O={style:{display:"block",width:"35%"}},V=["disabled"],q={key:0},z={key:1},D=k({__name:"forgetPassword",setup(M){j({title:"Login"});const n=i(""),c=i(""),{apiBaseUrl:v}=b();T();const a=i(60),l=i(!1),g=()=>{l.value=!0,a.value=60;const t=A(()=>{a.value>0?a.value--:(clearInterval(t),l.value=!1)},1e3)};async function y(t){if(c.value==""){o({message:"请输入验证码！",type:"warning"});return}try{const e=await fetch(v.value+"auth/reset_password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n.value,code:c.value})}),r=await e.json();e.ok?(o({showClose:!0,duration:0,message:"您的密码已被重置为123456,请您马上登录修改密码",type:"warning"}),S("/login")):o({message:"验证码错误！",type:"error"})}catch(e){console.error("Login error:",e)}}function w(t){return/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(t)}async function _(){if(!w(n.value)){o.error("请输入正确的邮箱！");return}console.log(n.value);try{const t=await fetch(v.value+"auth/send_reset_code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n.value})}),e=await t.json();t.ok?(o({message:"已发送验证码！",type:"success"}),g()):o.error("该邮箱与任何账号绑定！")}catch{}}return(t,e)=>(d(),u("div",B,[s("div",E,[s("div",P,[e[6]||(e[6]=s("div",{class:"title"},"Retrieve Password",-1)),s("form",null,[s("div",I,[m(s("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=r=>t.username=r),required:""},null,512),[[f,t.username]]),e[2]||(e[2]=s("label",{for:"email"},"Email",-1))]),s("div",N,[m(s("input",{type:"password","onUpdate:modelValue":e[1]||(e[1]=r=>t.password=r),required:"",style:{width:"55%"}},null,512),[[f,t.password]]),e[3]||(e[3]=s("label",{for:"code"},"验证码",-1)),s("div",O,[s("button",{class:"btn2",onClick:_,disabled:p(l)},[p(l)?(d(),u("div",q,h(p(a))+" 秒",1)):(d(),u("div",z,"发送"))],8,V)])]),e[5]||(e[5]=s("div",null,null,-1)),s("div",{style:{display:"flex","justify-content":"center"}},[s("button",{class:"btn",onClick:y},e[4]||(e[4]=[C("确认 "),s("span",null,null,-1),s("span",null,null,-1),s("span",null,null,-1)]))])])]),e[7]||(e[7]=s("div",{class:"links"},[s("div",null,[s("a",{href:"/",class:"link"},"返回主页")]),s("div",null,[s("a",{href:"/register",class:"link"},"注册")])],-1))])]))}}),F=x(D,[["__scopeId","data-v-62ec77d3"]]);export{F as default};
