import{x as E,y as M,j as $,z as x,A as I,B as U,C as V,D as j,_ as J,g as O,E as N,G as P,H as q,o as u,e as T,w as B,c as f,n as m,l as k,k as C,I as R,J as Z,m as y,a as t,q as S,v as z,i as l,s as A,t as F,K as L}from"./DIeUT0Iv.js";import{u as G}from"./CyEfYi4p.js";import{E as g}from"./CCiOLUzT.js";import{u as H}from"./myxEe2Y1.js";import{u as K}from"./Du8ibXpn.js";import"./O4DT29vE.js";const W=(r,o,s,i,d=!1)=>{const n=E(),b=M(),v=$(()=>{var p;const c=x(o),a=x(s),e=x(i);return I((c==null?void 0:c.strategy)||((p=b.ui)==null?void 0:p.strategy),e?{wrapper:e}:{},c||{},d?U(b.ui,r,{}):{},a||{})}),w=$(()=>V(n,["class"]));return{ui:v,attrs:w}},D={base:"invisible before:visible before:block before:rotate-45 before:z-[-1] before:w-2 before:h-2",ring:"before:ring-1 before:ring-gray-200 dark:before:ring-gray-800",rounded:"before:rounded-sm",background:"before:bg-gray-200 dark:before:bg-gray-800",shadow:"before:shadow",placement:"group-data-[popper-placement*='right']:-left-1 group-data-[popper-placement*='left']:-right-1 group-data-[popper-placement*='top']:-bottom-1 group-data-[popper-placement*='bottom']:-top-1"},_={container:"z-20 group",trigger:"flex items-center w-full",width:"w-full",height:"max-h-60",base:"relative focus:outline-none overflow-y-auto scroll-py-1",background:"bg-white dark:bg-gray-800",shadow:"shadow-lg",rounded:"rounded-md",padding:"p-1",ring:"ring-1 ring-gray-200 dark:ring-gray-700",empty:"text-sm text-gray-400 dark:text-gray-500 px-2 py-1.5",option:{base:"cursor-default select-none relative flex items-center justify-between gap-1",rounded:"rounded-md",padding:"px-1.5 py-1.5",size:"text-sm",color:"text-gray-900 dark:text-white",container:"flex items-center gap-1.5 min-w-0",active:"bg-gray-100 dark:bg-gray-900",inactive:"",selected:"pe-7",disabled:"cursor-not-allowed opacity-50",empty:"text-sm text-gray-400 dark:text-gray-500 px-2 py-1.5",icon:{base:"flex-shrink-0 h-5 w-5",active:"text-gray-900 dark:text-white",inactive:"text-gray-400 dark:text-gray-500"},selectedIcon:{wrapper:"absolute inset-y-0 end-0 flex items-center",padding:"pe-2",base:"h-5 w-5 text-gray-900 dark:text-white flex-shrink-0"},avatar:{base:"flex-shrink-0",size:"2xs"},chip:{base:"flex-shrink-0 w-2 h-2 mx-1 rounded-full"}},transition:{leaveActiveClass:"transition ease-in duration-100",leaveFromClass:"opacity-100",leaveToClass:"opacity-0"},popper:{placement:"bottom-end"},default:{selectedIcon:"i-heroicons-check-20-solid",trailingIcon:"i-heroicons-chevron-down-20-solid"},arrow:{...D,ring:"before:ring-1 before:ring-gray-200 dark:before:ring-gray-700",background:"before:bg-white dark:before:bg-gray-700"}};({..._,option:{..._.option},arrow:{...D}});const Q={base:"",background:"bg-white dark:bg-gray-900",divide:"divide-y divide-gray-200 dark:divide-gray-800",ring:"ring-1 ring-gray-200 dark:ring-gray-800",rounded:"rounded-lg",shadow:"shadow",body:{base:"",background:"",padding:"px-4 py-5 sm:p-6"},header:{base:"",background:"",padding:"px-4 py-5 sm:px-6"},footer:{base:"",background:"",padding:"px-4 py-4 sm:px-6"}},X=I(j.ui.strategy,j.ui.card,Q),Y=O({inheritAttrs:!1,props:{as:{type:String,default:"div"},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(r){const{ui:o,attrs:s}=W("card",N(r,"ui"),X),i=$(()=>P(q(o.value.base,o.value.rounded,o.value.divide,o.value.ring,o.value.shadow,o.value.background),r.class));return{ui:o,attrs:s,cardClass:i}}});function ee(r,o,s,i,d,n){return u(),T(Z(r.$attrs.onSubmit?"form":r.as),R({class:r.cardClass},r.attrs),{default:B(()=>[r.$slots.header?(u(),f("div",{key:0,class:m([r.ui.header.base,r.ui.header.padding,r.ui.header.background])},[k(r.$slots,"header")],2)):C("",!0),r.$slots.default?(u(),f("div",{key:1,class:m([r.ui.body.base,r.ui.body.padding,r.ui.body.background])},[k(r.$slots,"default")],2)):C("",!0),r.$slots.footer?(u(),f("div",{key:2,class:m([r.ui.footer.base,r.ui.footer.padding,r.ui.footer.background])},[k(r.$slots,"footer")],2)):C("",!0)]),_:3},16,["class"])}const re=J(Y,[["render",ee]]),te=window.setInterval,oe={class:"min-h-screen flex items-center justify-center bg-gray-50"},ae={class:"max-w-md w-full space-y-8 border border-gray-300 p-6"},se={class:"mt-8 space-y-6"},ne={class:"rounded-md shadow-sm -space-y-px"},ie={class:"flex w-full"},de=["disabled"],le={key:0},ue={key:1},me=O({__name:"forgetPassword",setup(r){K({title:"Login"});const o=y(""),s=y(""),{apiBaseUrl:i}=G();H();const d=y(60),n=y(!1),b=()=>{n.value=!0,d.value=60;const a=te(()=>{d.value>0?d.value--:(clearInterval(a),n.value=!1)},1e3)};async function v(a){if(s.value==""){g({message:"请输入验证码！",type:"warning"});return}try{const e=await fetch(i.value+"auth/reset_password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o.value,code:s.value})}),p=await e.json();e.ok?(g({showClose:!0,duration:0,message:"您的密码已被重置为123456,请您马上登录修改密码",type:"warning"}),L("/login")):g({message:"验证码错误！",type:"error"})}catch(e){console.error("Login error:",e)}}function w(a){return/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(a)}async function c(){if(!w(o.value)){g.error("请输入正确的邮箱！");return}console.log(o.value);try{const a=await fetch(i.value+"auth/send_reset_code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o.value})}),e=await a.json();a.ok?(g({message:"已发送验证码！",type:"success"}),b()):g.error("该邮箱与任何账号绑定！")}catch{}}return(a,e)=>{const p=re;return u(),T(p,{class:"w-full bg-white/75 dark:bg-white/5 backdrop-blur"},{default:B(()=>[t("div",oe,[t("div",ae,[e[5]||(e[5]=t("div",{class:"flex items-center justify-between"},[t("div",{class:"text-sm"},[t("a",{href:"/login",class:"font-medium text-indigo-600 hover:text-indigo-500"}," 返回登录 ")])],-1)),e[6]||(e[6]=t("div",null,null,-1)),e[7]||(e[7]=t("div",null,[t("h2",{class:"mt-6 text-center text-3xl font-extrabold text-gray-900"}," 忘记密码 ")],-1)),t("div",se,[t("div",ne,[t("div",null,[e[2]||(e[2]=t("label",{for:"email",class:"sr-only"},"邮箱",-1)),S(t("input",{id:"email",name:"email",type:"text","onUpdate:modelValue":e[0]||(e[0]=h=>A(o)?o.value=h:null),autocomplete:"email",required:"",class:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"邮箱"},null,512),[[z,l(o)]])]),e[4]||(e[4]=t("div",null,null,-1)),t("div",ie,[e[3]||(e[3]=t("label",{for:"code",class:"sr-only"},"验证码",-1)),S(t("input",{id:"code",name:"code",type:"text","onUpdate:modelValue":e[1]||(e[1]=h=>A(s)?s.value=h:null),autocomplete:"current-password",class:"appearance-none rounded-none w-3/5 relative block px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"验证码"},null,512),[[z,l(s)]]),t("button",{class:m(["group relative w-2/5 flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",{"bg-indigo-600 hover:bg-indigo-700":!l(n),"bg-indigo-300 cursor-not-allowed":l(n)}]),onClick:c,disabled:l(n)},[l(n)?(u(),f("div",le,F(l(d))+" 秒",1)):(u(),f("div",ue,"发送验证码"))],10,de)])]),t("div",{class:"mt-6 flex justify-between"},[t("button",{type:"button",class:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:v}," 确定 ")])])])])]),_:1})}}});export{me as default};
